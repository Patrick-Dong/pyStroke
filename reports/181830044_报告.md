# CG Project Report

## About

**Month	Sep.**

**author	董宸郅**

**mail	181830044@smail.nju.edu.cn**

## Progress
- 建立整体代码框架、git repo
- `cg_algorithm.py`中的`draw_line()`、`draw_polygon()`
- `cg_cli.py`中相关算法的命令行处理

## Algorithms

### 直线生成

#### DDA算法

DDA算法是计算机图形学基本的绘制直线算法，主要的思想来源于$y=kx+b$， 已知两个端点$(x_0,y_0),(x_1，y_1)$就可以知道k和b具体的值；

实际操作中绘画直线是一个迭代的过程，相对于前一个点$(x_i,y_i)$，后一个点$(x_{i+1}，y_{i+1})$可以记作:

- $$x_{i+1}=x_i+x_{Step}$$

- $$y_{i+1}=y_i+y_{Step}$$

$x_{Step}$，$y_{Step}$是通过$dx=abs(x0-x1),dy=abs(y_0-y_1)$的比较确定的：

- 如果$dx>dy$，那么x轴方向上面两个点的距离更远，置$x_{Step}=1,y_{Step}=k$
- 反之，则y轴方向上面两个点的距离更远，置$x_{Step}=1/k, y_{Step}=1$

#### Bresenham算法

DDA算法的弊端在于浮点数运算的速度一般比较慢，Bresenham的好处则是仅仅使用了整数增量运算；

以下是Bresenham算法的分析:

假设起点是(x0，y0)，终点是(x1，y1)，那么斜率m为$\frac{y1-y0}{x1-x0}=\frac{dy}{dx}$；

在画图时实际坐标是整数的，就需要找到更加接近于真实点的那个整数点；如果固定$x_k$，那么这个整数点的选择就在$y_k$和$y_k+1$两者之间展开:

对于直线$y=mx+c (0<=|m|<=1)$，已知下一个$x=xk+1$，那么下一个$y=m(xk+1)+c$

$$d1=y-yk=m(xk+1)+c-yk$$

$$d2=yk+1-y=yk+1-m(xk+1)-c$$

又：

$$d1-d2=m(xk+1)+c-yk-(yk+1-m(xk+1)-c)=2m(xk+1)-2yk+2c-1$$

得决策变量：

$$p_k=2dyx_k-2dxy_k+c$$

$p_k=2dyx_k-2dxy_k+(2dy+2dxc-dx)=2dyx_k-2dxy_k+c$

因为$dx>0$，从而$p_k$和$(d1-d2)$同号，可以得到如下的结论:

- 如果$p_k>0$，那么$d1-d2>0$，$y_k+1$距离真实的y更接近，选择$(x_{k+1},y_k+1)$；
- 如果$p_k<0$，那么$d1-d2<0$，$y_k$距离真实的y更接近，选择$(x_{k+1},y_k)$；

根据$p_k$的公式，$p_{k+1}-p_k=2dy(x_{k+1}-x_k)-2dx(y_{k+1}-yk)$

且$x_{k+1}=x_k+1$，由此得知决策参数的增量公式；

- 若$p_k>0$，$y_{k+1}=y_k+1$，$p_{k+1}=p_k+2dy-2dx$
- 若$p_k< 0$，$y_{k+1}=y_k$，$p_{k+1}=p_k+2dy$

从而，Bresenham的算法流程处理如下:


1. 选择起始点$(x_0,y_0)$，终止点$(x_1，y_1)$，满足$x1>x0$，否则交换；计算得到$dx=x_1-x_0,dy=y_1-y_0; p_0=2dy-dx$

2. 从$k=0$开始，已知$(x_k，y_k), p_k$，计算下一个要画的点$(x_{k+1}，y_{k+1})$以及决策变量$p_{k+1}$:

3. 循环直到$x_k=x1$；

当斜率为其他情况的时候，主要是一些正负号的问题；其中当斜率为正无穷和0的时候需要像处理DDA算法一样进行特判。

### 多边形生成

多边形只需要通过给定的一系列点，多次调用直线生成算法即可完成。

## References

《计算机图形学教程》 by 孙正兴

计算机图形学 上课ppt

计算机图形学----DDA、Bresenham直线算法  by ljheee
https://blog.csdn.net/ljheee/article/details/73235302?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-2.channel_param&depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-2.channel_param

【计算机图形学】直线的两种生成算法（DDA算法、Bresenham算法）by 酱懵静
https://blog.csdn.net/the_ZED/article/details/105546159?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-3.channel_param&depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-3.channel_param

【计算机图形学】DDA算法和Bresenham算法 by MMomega
https://blog.csdn.net/mmogega/article/details/53055596?utm_medium=distribute.pc_relevant.none-task-blog-title-2&spm=1001.2101.3001.4242